# 重构聊天界面提示词逻辑

## 目标

将chat.html中的提示词拼凑逻辑剥离到一个新的JS文件中，使主文件更简洁。

## 具体步骤

1. **创建新文件** **`promptBuilder_storyteller.js`**

   * 提取 `callDeepSeekAPI` 函数中的提示词处理逻辑

   * 封装为独立的函数模块

   * 包含以下功能：

     * 加载和处理prompt.json

     * 加载和处理data.json

     * 拼装完整的系统提示词

     * 准备API请求数据结构

2. **修改** **`chat.html`** **文件**

   * 在head部分引入新的 `promptBuilder.js` 文件

   * 简化 `callDeepSeekAPI` 函数，调用新模块的方法

   * 移除已迁移的代码，保持主文件逻辑清晰

3. **确保功能完整性**

   * 保持所有现有功能不变

   * 确保API调用流程正常

   * 验证错误处理机制仍然有效

## 技术要点

* 使用模块化设计，提高代码可维护性

* 保持函数职责单一，便于测试和调试

* 确保文件加载和错误处理逻辑完整

